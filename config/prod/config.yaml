environment: prod
# ================================
# 生产环境配置（prod）
#
# 说明：本项目会同时监控两个交易子账户的权益与保证金占用情况：
# - 当两个账户的权益差额超过阈值时触发转账（再平衡）
# - 当保证金使用率过高时触发紧急减仓（unwind）以降低爆仓风险
#
# 配置优先级：运行时由 `GRVT_ENV` 决定读取 `config/<env>/config.yaml`
# ================================

# 触发转账阈值（USDT）：当 |账户A余额 - 账户B余额| >= 该值 时触发再平衡
triggerValue: 3000

# 主循环间隔（秒）：每隔多少秒检查一次并尝试执行再平衡
rebalanceIntervalSec: 10

# 只执行一次后退出（用于手动测试/排障）；生产环境通常保持 false
rebalanceOnce: false

# 资金归集阈值（USDT）：当 funding 账户中 USDT 余额高于该值时，自动划转到 trading 子账户
fundingSweepThreshold: 0.1

# 可用余额告警阈值（百分比）：当 (available / equity * 100) < 该值 时发送 Telegram 告警（
# 可用余额不足的情况, 一般出现在一个账户大量未实现盈利的时候. 这时候你需要手动关一些仓位,释放盈利）
minAvailableBalanceAlertPercentage: 20
bot:
  # Telegram：建议通过环境变量设置（.env / .env.prod）
  # - TELEGRAM_BOT_TOKEN：机器人 token
  # - TELEGRAM_CHAT_ID：允许接收/发送命令的 chat id（用于限制只有你能操作机器人）
  token: ""
  chat_id: ""

# ================================
# 紧急减仓（unwind）
#
# 保证金使用率 = maintenance_margin / equity
# - 100% 表示达到爆仓线
#
# 建议：先在 test 环境验证逻辑，再在 prod 逐步放开（慎用 dryRun=false）
# ================================
unwind:
  # 是否启用紧急减仓逻辑
  enabled: true

  # 是否仅演练（true=只记录/告警，不真正减仓；false=真正减仓）
  dryRun: false

  # 触发阈值（百分比）：当保证金使用率 >= 该值 时触发减仓
  triggerPct: 60

  # 恢复阈值（百分比）：当保证金使用率 < 该值 时停止减仓
  recoveryPct: 40

  # 两轮减仓之间的冷却时间（秒）
  waitSecondsBetweenIterations: 2

  # 最小仓位名义价值（USDT）：小于该值的仓位会被跳过，避免过多小单
  minPositionNotional: 100
